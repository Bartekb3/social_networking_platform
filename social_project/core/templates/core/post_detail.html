{% extends 'core/base.html' %}

{% block title %}Post Details{% endblock %}

{% block content %}
<div class="post-detail-container">
  
  <!-- Author + Post Card -->
  <article class="post-detail-card">
    <!-- Post Detail Header -->
    <header class="post-detail-header">
      <!-- Optional Author Avatar (if you have a user avatar system) -->
      <div class="post-detail-author">
        <a href="{% url 'profile' post.author.id %}">
          <img 
            {% comment %} src="{% static 'core/default_avatar.png' %}"  {% endcomment %}
            alt="{{ post.author.username }}" 
            class="author-avatar"
          >
        </a>
        <div>
          <h2>{{ post.author.username }}</h2>
          <small>Posted on {{ post.created_at|date:"F j, Y, g:i a" }}</small>
        </div>
      </div>

      <!-- Like Count + Like Button -->
      <div class="post-detail-like">
        <button 
          class="like-button" 
          data-post-id="{{ post.id }}" 
          data-like-url="{% url 'like_post' post.id %}"
        >
          {% if user in post.likes.all %}
            Unlike ({{ post.likes.count }})
          {% else %}
            Like ({{ post.likes.count }})
          {% endif %}
        </button>
      </div>
    </header>

    <!-- Post Content -->
    <section class="post-detail-content">
      <p>{{ post.content }}</p>
    </section>
  </article>

  <!-- Comments Section -->
  <section class="comments-section">
    <header>
      <h3>Comments</h3>
    </header>
    
    <!-- Existing Comments -->
    {% if comments %}
      <ul class="comment-list" id="comment-list-{{ post.id }}">
        {% for comment in comments %}
        <li class="comment-item">
          <div class="comment-author">
            <strong>{{ comment.author.username }}</strong>
            {% comment %} <small>{{ comment.created_at|naturaltime }}</small> {% endcomment %}
          </div>
          <p class="comment-text">{{ comment.content }}</p>
        </li>
        {% endfor %}
      </ul>
    {% else %}
      <p>No comments yet.</p>
      <ul class="comment-list" id="comment-list-{{ post.id }}"></ul>
    {% endif %}

    <!-- Add a Comment Form -->
    <form class="comment-form" data-post-id="{{ post.id }}">
      {% csrf_token %}
      <textarea 
        name="content" 
        rows="2" 
        placeholder="Write a comment..." 
        required
      ></textarea>
      <button type="submit">Comment</button>
    </form>
  </section>
</div>
{% endblock %}


{%comment%}
{% extends 'core/base.html' %}

{% block title %}Post Details{% endblock %}

{% block content %}
<section class="post-detail-section">
  <article class="post-detail-card">
    <header>
      <h2>{{ post.author.username }}'s Post</h2>
      <small>Posted on {{ post.created_at|date:"F j, Y, g:i a" }}</small>
    </header>

    <p>{{ post.content }}</p>

    <footer>
      <!-- Like Button with count -->
      <button class="like-button" 
              data-post-id="{{ post.id }}" 
              data-like-url="{% url 'like_post' post.id %}">
        {% if user in post.likes.all %}
          Unlike ({{ post.likes.count }})
        {% else %}
          Like ({{ post.likes.count }})
        {% endif %}
      </button>
    </footer>
  </article>

  <hr>

  <!-- Comments Section -->
  <section class="comments-section">
    <h3>Comments</h3>
    
    {% if comments %}
    <ul class="comment-list" id="comment-list-{{ post.id }}">
      {% for comment in comments %}
      <li class="comment-item">
        <strong>{{ comment.author.username }}</strong> 
        <span>{{ comment.content }}</span>
        {% comment %} <small>{{ comment.created_at|naturaltime }}</small> {% endcomment %}

        {%comment%}
      </li>
      {% endfor %}
    </ul>
    {% else %}
      <p>No comments yet.</p>
      <ul class="comment-list" id="comment-list-{{ post.id }}"></ul>
    {% endif %}

    <!-- Comment Form -->
    <form class="comment-form" data-post-id="{{ post.id }}">
      {% csrf_token %}
      <textarea name="content" rows="2" placeholder="Write a comment..." required></textarea>
      <button type="submit">Comment</button>
    </form>
  </section>
</section>
{% endblock %}

{%comment%}
{% extends 'core/base.html' %}

{% block title %}Post Details{% endblock %}

{% block content %}
<article>
  <header>
    <h2>{{ post.author.username }}'s Post</h2>
    <p>{{ post.content }}</p>
    <p><small>Posted on {{ post.created_at|date:"F j, Y, g:i a" }}</small></p>
  </header>
  <footer>
    <p id="like-count-{{ post.id }}">{{ post.likes.count }} likes</p>
    <button class="like-button" data-post-id="{{ post.id }}" data-like-url="{% url 'like_post' post.id %}">
      {% if user in post.likes.all %}Unlike{% else %}Like{% endif %}
    </button>
  </footer>
</article>

<section>
  <h3>Comments</h3>
  <ul id="comment-list-{{ post.id }}">
    {% for comment in comments %}
    <li>
      <strong>{{ comment.author.username }}</strong>: {{ comment.content }}
    </li>
    {% empty %}
    <p>No comments yet.</p>
    {% endfor %}
  </ul>

  <form class="comment-form" data-post-id="{{ post.id }}">
    {% csrf_token %}
    <textarea name="content" rows="2" placeholder="Write a comment..." required></textarea>
    <button type="submit">Comment</button>
  </form>
</section>
{% endblock %}

{% comment %} {% extends 'core/base.html' %}

{% block title %}Post Details{% endblock %}

{% block content %}
<article>
    <header>
        <h2>{{ post.author.username }}'s Post</h2>
        <p>{{ post.content }}</p>
        <p><small>Posted on {{ post.created_at|date:"F j, Y, g:i a" }}</small></p>
    </header>
    <footer>
        <p id="like-count-{{ post.id }}">{{ post.likes.count }} likes</p>
                        <button class="like-button" data-post-id="{{ post.id }}" data-like-url="{% url 'like_post' post.id %}">
                            {% if user in post.likes.all %}
                            Unlike
                            {% else %}
                            Like
                            {% endif %}
                        </button>
    </footer>
</article>

<section>
    <h3>Comments</h3>
    <ul>
        {% for comment in comments %}
        <li>
            <strong>{{ comment.author.username }}</strong>: {{ comment.content }}
        </li>
        {% empty %}
        <p>No comments yet.</p>
        {% endfor %}
    </ul>

    <form class="comment-form" data-post-id="{{ post.id }}">
        {% csrf_token %}
        <textarea name="content" rows="2" placeholder="Write a comment..." required></textarea>
        <button type="submit">Comment</button>
    </form>
</section>
{% endblock %} {% endcomment %}
